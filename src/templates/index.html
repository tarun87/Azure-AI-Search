<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Azure AI Search Demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="mb-4">Document Search</h1>
        
        <div class="row mb-4">
            <div class="col">
                <div class="input-group">
                    <input type="text" id="searchInput" class="form-control" placeholder="Enter your search query...">
                    <button class="btn btn-primary" onclick="search()">Search</button>
                </div>
            </div>
        </div>

        <div class="row mb-3">
            <div class="col">
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="searchType" id="standardSearch" value="standard" checked>
                    <label class="form-check-label" for="standardSearch">Standard Search</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="searchType" id="semanticSearch" value="semantic">
                    <label class="form-check-label" for="semanticSearch">Semantic Search</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="searchType" id="vectorSearch" value="vector">
                    <label class="form-check-label" for="vectorSearch">Vector Search</label>
                </div>
            </div>
        </div>

        <div id="results" class="mt-4"></div>
    </div>

    <script>
        async function search() {
            const query = document.getElementById('searchInput').value;
            const searchType = document.querySelector('input[name="searchType"]:checked').value;
            
            if (!query) return;

            try {
                const response = await fetch('/search', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        query: query,
                        semantic: searchType === 'semantic',
                        vector: searchType === 'vector'
                    })
                });

                const data = await response.json();
                displayResults(data.results);
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('results').innerHTML = `<div class="alert alert-danger">Error performing search</div>`;
            }
        }

        function displayResults(results) {
            const resultsDiv = document.getElementById('results');
            if (!results || results.length === 0) {
                resultsDiv.innerHTML = '<div class="alert alert-info">No results found</div>';
                return;
            }

            let html = '';
            results.forEach(result => {
                html += `
                    <div class="card mb-3">
                        <div class="card-body">
                            <h5 class="card-title">${result.title}</h5>
                            <h6 class="card-subtitle mb-2 text-muted">Score: ${result.score}</h6>
                            <p class="card-text">${result.content.substring(0, 200)}...</p>
                            ${result.entities.length ? `<p class="card-text"><small class="text-muted">Entities: ${result.entities.join(', ')}</small></p>` : ''}
                            <p class="card-text"><small class="text-muted">Language: ${result.language}</small></p>
                        </div>
                    </div>
                `;
            });

            resultsDiv.innerHTML = html;
        }
    </script>
</body>
</html>
